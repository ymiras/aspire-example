# YmirasCloud - åŸºäº .NET Aspire çš„å¾®æœåŠ¡ç”µå•†å¹³å°

## é¡¹ç›®æ¦‚è¿°

YmirasCloud æ˜¯ä¸€ä¸ªåŸºäº .NET Aspire æ„å»ºçš„ç°ä»£åŒ–å¾®æœåŠ¡ç”µå•†å¹³å°ï¼Œé‡‡ç”¨äº‘åŸç”Ÿæ¶æ„è®¾è®¡ï¼Œé›†æˆäº† AI åŠŸèƒ½ã€åˆ†å¸ƒå¼ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œèº«ä»½è®¤è¯ç­‰ä¼ä¸šçº§ç‰¹æ€§ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     WebApp      â”‚    â”‚     Catalog     â”‚    â”‚     Basket      â”‚
â”‚   (Blazor UI)   â”‚â—„â”€â”€â–ºâ”‚   (Product API) â”‚â—„â”€â”€â–ºâ”‚  (Cart Service) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   AppHost       â”‚
                    â”‚ (Orchestrator)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœåŠ¡ç»„ä»¶

#### ğŸ”§ æ ¸å¿ƒæœåŠ¡

- **AppHost**: åº”ç”¨ç¨‹åºç¼–æ’å™¨ï¼Œè´Ÿè´£æœåŠ¡å‘ç°å’Œä¾èµ–ç®¡ç†
- **Catalog**: äº§å“ç›®å½•æœåŠ¡ï¼Œæä¾›äº§å“ç®¡ç†å’Œ AI æœç´¢åŠŸèƒ½
- **Basket**: è´­ç‰©è½¦æœåŠ¡ï¼Œç®¡ç†ç”¨æˆ·è´­ç‰©è½¦çŠ¶æ€
- **WebApp**: Blazor å‰ç«¯åº”ç”¨ï¼Œæä¾›ç”¨æˆ·ç•Œé¢

#### ğŸ› ï¸ åŸºç¡€è®¾æ–½æœåŠ¡

- **PostgreSQL**: ä¸»æ•°æ®åº“ï¼Œå­˜å‚¨äº§å“ä¿¡æ¯
- **Redis**: åˆ†å¸ƒå¼ç¼“å­˜ï¼Œç”¨äºè´­ç‰©è½¦å’Œè¾“å‡ºç¼“å­˜
- **RabbitMQ**: æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤„ç†æœåŠ¡é—´é€šä¿¡
- **Keycloak**: èº«ä»½è®¤è¯å’ŒæˆæƒæœåŠ¡
- **Ollama**: AI æ¨¡å‹æœåŠ¡ï¼Œæä¾›èŠå¤©å’Œå‘é‡æœç´¢åŠŸèƒ½

#### ğŸ“¦ å…±äº«ç»„ä»¶

- **ServiceDefaults**: é€šç”¨æœåŠ¡é…ç½®ï¼ŒåŒ…æ‹¬å¥åº·æ£€æŸ¥ã€OpenTelemetry å’Œæ¶ˆæ¯ä¼ é€’

## ğŸš€ ä¸»è¦åŠŸèƒ½

### äº§å“ç®¡ç†

- äº§å“çš„ CRUD æ“ä½œ
- äº§å“æœç´¢å’Œè¿‡æ»¤
- AI é©±åŠ¨çš„æ™ºèƒ½æœç´¢
- äº§å“ä»·æ ¼å˜æ›´äº‹ä»¶é€šçŸ¥

### è´­ç‰©è½¦åŠŸèƒ½

- ç”¨æˆ·è´­ç‰©è½¦ç®¡ç†
- è´­ç‰©è½¦æŒä¹…åŒ–å­˜å‚¨
- ä¸äº§å“æœåŠ¡çš„é›†æˆ
- JWT èº«ä»½è®¤è¯

### AI é›†æˆ

- åŸºäº Ollama çš„èŠå¤©åŠŸèƒ½
- å‘é‡åŒ–äº§å“æœç´¢
- æ™ºèƒ½äº§å“æ¨è
- è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ”¯æŒ

### ç”¨æˆ·ä½“éªŒ

- å“åº”å¼ Blazor UI
- å®æ—¶æ•°æ®æ›´æ–°
- è¾“å‡ºç¼“å­˜ä¼˜åŒ–
- æµå¼æ¸²æŸ“

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯

- **.NET 8**: ä¸»è¦å¼€å‘æ¡†æ¶
- **ASP.NET Core**: Web API æ¡†æ¶
- **Entity Framework Core**: ORM æ¡†æ¶
- **MassTransit**: æ¶ˆæ¯ä¼ é€’æ¡†æ¶
- **OpenTelemetry**: å¯è§‚æµ‹æ€§

### å‰ç«¯æŠ€æœ¯

- **Blazor Server**: äº¤äº’å¼ Web UI
- **Bootstrap**: UI ç»„ä»¶åº“
- **SignalR**: å®æ—¶é€šä¿¡

### åŸºç¡€è®¾æ–½

- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²
- **PostgreSQL**: å…³ç³»å‹æ•°æ®åº“
- **Redis**: å†…å­˜æ•°æ®åº“
- **RabbitMQ**: æ¶ˆæ¯ä»£ç†
- **Keycloak**: èº«ä»½ç®¡ç†
- **Ollama**: AI æ¨¡å‹æœåŠ¡

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### å¼€å‘ç¯å¢ƒ

- .NET 8 SDK
- Docker Desktop
- Visual Studio 2022 æˆ– VS Code
- è‡³å°‘ 8GB RAMï¼ˆæ¨è 16GBï¼‰

### è¿è¡Œæ—¶è¦æ±‚

- Windows 10/11 æˆ– Linux/macOS
- Docker Desktop æˆ– Docker Engine
- è‡³å°‘ 4GB å¯ç”¨å†…å­˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/ymiras/aspire-example.git
cd aspire-example
```

### 2. å¯åŠ¨åº”ç”¨ç¨‹åº

```bash
# ä½¿ç”¨ .NET CLI
dotnet run --project AppHost

# æˆ–ä½¿ç”¨ Visual Studio
# å³é”®ç‚¹å‡» AppHost é¡¹ç›® -> è®¾ä¸ºå¯åŠ¨é¡¹ç›® -> F5
```

### 3. è®¿é—®åº”ç”¨

- **Web åº”ç”¨**: https://localhost:5001
- **äº§å“ API**: https://localhost:5002
- **è´­ç‰©è½¦ API**: https://localhost:5003
- **Keycloak ç®¡ç†**: http://localhost:8080
- **PgAdmin**: http://localhost:5050
- **Redis Insight**: http://localhost:8001
- **RabbitMQ ç®¡ç†**: http://localhost:15672

## ğŸ“ é¡¹ç›®ç»“æ„

```
aspire-example/
â”œâ”€â”€ AppHost/                 # åº”ç”¨ç¨‹åºç¼–æ’å™¨
â”œâ”€â”€ ServiceDefaults/         # å…±äº«æœåŠ¡é…ç½®
â”œâ”€â”€ Services/               # å¾®æœåŠ¡
â”‚   â”œâ”€â”€ Catalog/           # äº§å“ç›®å½•æœåŠ¡
â”‚   â””â”€â”€ Basket/            # è´­ç‰©è½¦æœåŠ¡
â”œâ”€â”€ Portal/                # å‰ç«¯åº”ç”¨
â”‚   â””â”€â”€ WebApp/            # Blazor Web åº”ç”¨
â””â”€â”€ YmirasCloud.sln        # è§£å†³æ–¹æ¡ˆæ–‡ä»¶
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

- `OTEL_EXPORTER_OTLP_ENDPOINT`: OpenTelemetry å¯¼å‡ºç«¯ç‚¹
- `APPLICATIONINSIGHTS_CONNECTION_STRING`: Azure Monitor è¿æ¥å­—ç¬¦ä¸²

### æœåŠ¡é…ç½®

- **Catalog**: è¿æ¥ PostgreSQL æ•°æ®åº“å’Œ Ollama AI æœåŠ¡
- **Basket**: ä½¿ç”¨ Redis ç¼“å­˜å’Œ Keycloak è®¤è¯
- **WebApp**: é›†æˆ Catalog å’Œ Basket æœåŠ¡

## ğŸ” API æ–‡æ¡£

### Catalog API

- `GET /products` - è·å–æ‰€æœ‰äº§å“
- `GET /products/{id}` - è·å–æŒ‡å®šäº§å“
- `POST /products` - åˆ›å»ºæ–°äº§å“
- `PUT /products/{id}` - æ›´æ–°äº§å“
- `DELETE /products/{id}` - åˆ é™¤äº§å“
- `GET /products/search/{query}` - æœç´¢äº§å“
- `GET /products/aisearch/{query}` - AI æœç´¢äº§å“
- `GET /products/support/{query}` - AI æ”¯æŒæŸ¥è¯¢

### Basket API

- `GET /basket/{username}` - è·å–ç”¨æˆ·è´­ç‰©è½¦
- `POST /basket` - æ›´æ–°è´­ç‰©è½¦
- `DELETE /basket/{username}` - åˆ é™¤è´­ç‰©è½¦

## ğŸ” èº«ä»½è®¤è¯

é¡¹ç›®ä½¿ç”¨ Keycloak è¿›è¡Œèº«ä»½è®¤è¯ï¼š

- é¢†åŸŸ: `eshop`
- å®¢æˆ·ç«¯: `account`
- JWT Bearer Token è®¤è¯

## ğŸ“Š ç›‘æ§å’Œå¯è§‚æµ‹æ€§

- **å¥åº·æ£€æŸ¥**: `/health` å’Œ `/alive` ç«¯ç‚¹
- **OpenTelemetry**: åˆ†å¸ƒå¼è¿½è¸ªå’ŒæŒ‡æ ‡æ”¶é›†
- **æ—¥å¿—**: ç»“æ„åŒ–æ—¥å¿—è®°å½•
- **æŒ‡æ ‡**: ASP.NET Core å’Œ HTTP å®¢æˆ·ç«¯æŒ‡æ ‡

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
dotnet test

# è¿è¡Œç‰¹å®šé¡¹ç›®æµ‹è¯•
dotnet test Catalog.Tests
```

### API æµ‹è¯•

é¡¹ç›®åŒ…å« HTTP æ–‡ä»¶ç”¨äº API æµ‹è¯•ï¼š

- `Catalog/Catalog.http`
- `Basket/Basket.http`

## ğŸš€ éƒ¨ç½²

### æœ¬åœ°å¼€å‘

```bash
dotnet run --project AppHost
```

### Docker éƒ¨ç½²

```bash
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒ

1. é…ç½®ç¯å¢ƒå˜é‡
2. è®¾ç½®æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
3. é…ç½® Keycloak å’Œ Ollama
4. éƒ¨ç½²åˆ° Kubernetes æˆ–äº‘å¹³å°

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰ç–‘é—®ï¼š

1. æŸ¥çœ‹ [Issues](../../issues) é¡µé¢
2. åˆ›å»ºæ–°çš„ Issue
3. è”ç³»é¡¹ç›®ç»´æŠ¤è€…

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v1.0.0

- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€å¾®æœåŠ¡æ¶æ„
- AI é›†æˆåŠŸèƒ½
- èº«ä»½è®¤è¯ç³»ç»Ÿ
- åˆ†å¸ƒå¼ç¼“å­˜æ”¯æŒ

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº† .NET Aspire çš„å¾®æœåŠ¡æ¶æ„èƒ½åŠ›ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿è¿›è¡Œé€‚å½“çš„å®‰å…¨é…ç½®å’Œæ€§èƒ½ä¼˜åŒ–ã€‚
